{% extends "bienestar_layout/base_bienestar.html" %}
{% load static %}

{% block content %}
<div class="profile-view-wrapper py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-xl-10 col-lg-11">

                <!-- Header con acciones -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h2 class="fw-bold text-dark mb-1">Mi Perfil</h2>
                        <p class="text-muted mb-0">
                            <span class="badge bg-primary-custom">{{ persona.get_rol_display }}</span>
                        </p>
                    </div>
                    <a href="{% url 'accounts:editar_perfil' %}" class="btn btn-primary-custom">
                        <i class="bi bi-pencil me-2"></i>Editar Perfil
                    </a>
                </div>

                <!-- Card Principal -->
                <div class="card shadow-sm border-0 rounded-4 mb-4">
                    <div class="card-body p-5">

                        <!-- Datos Personales -->
                        <h5 class="fw-bold text-primary-custom mb-4">
                            <i class="bi bi-person-vcard me-2"></i>Datos Personales
                        </h5>
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Nombre Legal</label>
                                <p class="fw-semibold mb-0">{{ persona.nombre }} {{ persona.apellido }}</p>
                            </div>

                            {% if persona.nombre_percibido %}
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Nombre Percibido</label>
                                <p class="fw-semibold mb-0">
                                    {{ persona.nombre_percibido }}
                                    {% if persona.nombre_percibido_validado %}
                                    <span class="badge bg-success ms-2">Validado</span>
                                    {% else %}
                                    <span class="badge bg-warning ms-2">Pendiente</span>
                                    {% endif %}
                                </p>
                            </div>
                            {% endif %}

                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Documento</label>
                                <p class="fw-semibold mb-0">{{ persona.get_tipo_documento_display }} <span>{{ persona.documento }}</span></p>

                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Género</label>
                                <p class="fw-semibold mb-0">{{ persona.get_genero_display }}</p>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Nacionalidad</label>
                                <p class="fw-semibold mb-0">{{ persona.nacionalidad }}</p>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Sede</label>
                                <p class="fw-semibold mb-0">{{ persona.get_sede_display }}</p>
                            </div>
                        </div>

                        <hr class="my-4">

                        <!-- Datos de Contacto -->
                        <h5 class="fw-bold text-primary-custom mb-4">
                            <i class="bi bi-telephone me-2"></i>Datos de Contacto
                        </h5>
                        <div class="row mb-4">
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Correo Institucional</label>
                                <p class="fw-semibold mb-0">{{ persona.correo }}</p>
                            </div>

                            {% if persona.correo_personal %}
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Correo Personal</label>
                                <p class="fw-semibold mb-0">{{ persona.correo_personal }}</p>
                            </div>
                            {% endif %}

                            {% if persona.telefono %}
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Teléfono</label>
                                <p class="fw-semibold mb-0">{{ persona.telefono }}</p>
                            </div>
                            {% endif %}

                            {% if persona.contacto_emergencia_nombre %}
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Contacto de Emergencia</label>
                                <p class="fw-semibold mb-0">{{ persona.contacto_emergencia_nombre }}</p>
                                {% if persona.contacto_emergencia_telefono %}
                                <small class="text-muted">{{ persona.contacto_emergencia_telefono }}</small>
                                {% endif %}
                            </div>
                            {% endif %}
                        </div>

                        {% if perfil_especifico %}
                        <hr class="my-4">

                        <!-- Información Específica del Rol -->
                        {% if rol == 'estudiante' %}
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h5 class="fw-bold text-primary-custom mb-0">
                                <i class="bi bi-mortarboard me-2"></i>Información Académica
                            </h5>
                            {% if puede_cambiar_menu %}
                            <a href="{% url 'accounts:cambiar_preferencia_menu' %}"
                               class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-pencil me-1"></i>
                                Cambiar Preferencia de Menú
                            </a>
                            {% endif %}

                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Legajo</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.numero_legajo }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Carrera</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.carrera.nombre }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Dependencia</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.dependencia.nombre }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Año de Ingreso</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.anio_ingreso }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Estado Académico</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.get_estado_academico_display }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Preferencia de Menú</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.get_preferencia_menu_display }}</p>
                            </div>
                        </div>

                        {% elif rol == 'docente' %}
                        <h5 class="fw-bold text-primary-custom mb-4">
                            <i class="bi bi-book me-2"></i>Información Docente
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Legajo</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.numero_legajo }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Categoría</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.get_categoria_docente_display }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Dependencia</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.dependencia.nombre }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Fecha de Ingreso</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.fecha_ingreso_docencia|date:"d/m/Y"
                                    }}</p>
                            </div>
                        </div>

                        {% elif rol == 'no_docente' %}
                        <h5 class="fw-bold text-primary-custom mb-4">
                            <i class="bi bi-briefcase me-2"></i>Información Laboral
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Legajo</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.numero_legajo }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Cargo</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.cargo }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Área</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.area_principal.nombre }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Tipo de Contrato</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.get_tipo_contrato_display }}</p>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="small text-muted d-block mb-1">Fecha de Ingreso</label>
                                <p class="fw-semibold mb-0">{{ perfil_especifico.fecha_ingreso_laboral|date:"d/m/Y"
                                    }}</p>
                            </div>
                        </div>
                        {% endif %}
                        {% endif %}

                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<style>
    :root {
        --primary-custom: #2C7D4B;
    }

    .profile-view-wrapper {
        min-height: 80vh;
        background-color: #f8f9fa;
    }

    .text-primary-custom {
        color: var(--primary-custom) !important;
    }

    .bg-primary-custom {
        background-color: var(--primary-custom) !important;
    }

    .btn-primary-custom {
        background-color: var(--primary-custom);
        border: none;
        color: white;
    }

    .btn-primary-custom:hover {
        background-color: #1e5c35;
        color: white;
    }

    .btn-outline-primary {
        color: var(--primary-custom);
        border-color: var(--primary-custom);
    }

    .btn-outline-primary:hover {
        background-color: var(--primary-custom);
        border-color: var(--primary-custom);
        color: white;
    }
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
{% endblock content %}